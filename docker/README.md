# Docker Compose –¥–ª—è Production Analysis System

–≠—Ç–æ—Ç Docker Compose –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –ø–æ–ª–Ω–æ–≥–æ —Å—Ç–µ–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è: —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ (React), –±—ç–∫–µ–Ω–¥ (FastAPI) –∏ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (PostgreSQL).

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É –≤–∞—Å –µ—Å—Ç—å –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ `.env` —Ñ–∞–π–ª—ã:

```bash
# –ö–æ—Ä–Ω–µ–≤–æ–π .env –¥–ª—è –±—ç–∫–µ–Ω–¥–∞ –∏ –ë–î
cp ../.env.template ../.env
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ ../.env

# .env –¥–ª—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞
# –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ ../frontend/.env —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
```

### 2. –ó–∞–ø—É—Å–∫ —Å–∏—Å—Ç–µ–º—ã

```bash
# –°–¥–µ–ª–∞—Ç—å —Å–∫—Ä–∏–ø—Ç—ã –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º–∏
chmod +x *.sh

# –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
./start.sh
```

### 3. –î–æ—Å—Ç—É–ø –∫ —Å–µ—Ä–≤–∏—Å–∞–º

- **–§—Ä–æ–Ω—Ç–µ–Ω–¥**: http://localhost:3000
- **–ë—ç–∫–µ–Ω–¥ API**: http://localhost:8000
- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API**: http://localhost:8000/docs
- **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö**: localhost:5432

## üìã –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
./start.sh

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤  
./stop.sh

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
./logs.sh

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞
./logs.sh backend
./logs.sh frontend
./logs.sh postgres
```

### Docker Compose –∫–æ–º–∞–Ω–¥—ã

```bash
# –ó–∞–ø—É—Å–∫ –≤ —Ñ–æ–Ω–µ
docker-compose up -d

# –ó–∞–ø—É—Å–∫ —Å –ø–µ—Ä–µ—Å–±–æ—Ä–∫–æ–π
docker-compose up --build

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞
docker-compose down

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å —É–¥–∞–ª–µ–Ω–∏–µ–º volumes
docker-compose down -v

# –ü—Ä–æ—Å–º–æ—Ç—Ä —Å—Ç–∞—Ç—É—Å–∞
docker-compose ps

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
docker-compose logs -f [service_name]

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–∞
docker-compose restart [service_name]
```

## üîß –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –°–µ—Ä–≤–∏—Å—ã

1. **postgres** - –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö PostgreSQL 15
   - –ü–æ—Ä—Ç: 5432
   - Volume: postgres_data
   - Health check –≤–∫–ª—é—á–µ–Ω

2. **backend** - FastAPI –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
   - –ü–æ—Ä—Ç: 8000
   - –ó–∞–≤–∏—Å–∏—Ç –æ—Ç postgres
   - Hot reload –≤–∫–ª—é—á–µ–Ω —á–µ—Ä–µ–∑ volume mounting

3. **frontend** - React –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ  
   - –ü–æ—Ä—Ç: 3000
   - –ó–∞–≤–∏—Å–∏—Ç –æ—Ç backend
   - Hot reload –≤–∫–ª—é—á–µ–Ω —á–µ—Ä–µ–∑ volume mounting

### –°–µ—Ç—å

–í—Å–µ —Å–µ—Ä–≤–∏—Å—ã —Ä–∞–±–æ—Ç–∞—é—Ç –≤ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Å–µ—Ç–∏ `prod_analysis_network`.

## üõ† –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### Hot Reload

- **–ë—ç–∫–µ–Ω–¥**: –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–¥–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞—é—Ç FastAPI
- **–§—Ä–æ–Ω—Ç–µ–Ω–¥**: –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–¥–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è—é—Ç React

### Volume Mounting

–î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è volume mounts:
- –ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ –º–æ–Ω—Ç–∏—Ä—É–µ—Ç—Å—è –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
- –ò–∑–º–µ–Ω–µ–Ω–∏—è –æ—Ç—Ä–∞–∂–∞—é—Ç—Å—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ

## üîç –û—Ç–ª–∞–¥–∫–∞

### –ü—Ä–æ–±–ª–µ–º—ã —Å –∑–∞–ø—É—Å–∫–æ–º

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ .env —Ñ–∞–π–ª—ã**:
   ```bash
   ls -la ../.env ../frontend/.env
   ```

2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ—Ä—Ç—ã**:
   ```bash
   netstat -tulpn | grep -E ':(3000|8000|5432)'
   ```

3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏**:
   ```bash
   ./logs.sh
   ```

### –û—á–∏—Å—Ç–∫–∞

```bash
# –ü–æ–ª–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ (–æ—Å—Ç–æ—Ä–æ–∂–Ω–æ - —É–¥–∞–ª–∏—Ç –¥–∞–Ω–Ω—ã–µ –ë–î!)
docker-compose down -v
docker system prune -f

# –ü–µ—Ä–µ—Å–±–æ—Ä–∫–∞ –æ–±—Ä–∞–∑–æ–≤
docker-compose build --no-cache
```

## üì¶ Production

–î–ª—è production –æ–∫—Ä—É–∂–µ–Ω–∏—è —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è:

1. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–π docker-compose.prod.yml
2. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å reverse proxy (nginx)
3. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å secrets –¥–ª—è –ø–∞—Ä–æ–ª–µ–π
4. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
5. –î–æ–±–∞–≤–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- –í—Å–µ —Å–µ—Ä–≤–∏—Å—ã —Ä–∞–±–æ—Ç–∞—é—Ç –æ—Ç –Ω–µ–ø—Ä–∏–≤–∏–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –¥–æ—Å—Ç—É–ø–Ω–∞ —Ç–æ–ª—å–∫–æ –≤–Ω—É—Ç—Ä–∏ Docker —Å–µ—Ç–∏
- –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è health checks –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è
